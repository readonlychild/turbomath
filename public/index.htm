<html>
<head>
<title>Turbo Math</title>
  <meta name="viewport" content="user-scalable=no, width=device-width" />
	<link rel="stylesheet" href="minified/jquery-ui.min.css" />
	<script type="text/javascript" src="jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="jquery-ui-1.8.24.min.js"></script>
	<script type="text/javascript" src="turbomath.js"></script>
	<script type="text/javascript" src="turbomath.session.difficulty.methods.js"></script>
</head>
<style>
  body { font-family:'comic sans',arial; font-size:20pt; width:320px; }
  .operation { font-size:24pt; font-weight:bold; border:1px solid #ccc; background-color:#ddd; padding:12px; margin:5px; }
  .number    { display:inline-block; width:80px; text-align:right; }
  .operator  { clear:right; display:inline-block; width:40px; }
  .number2   { border-bottom:3px solid #000; }
  .answer-options div,
  #goodOnes, #badOnes, #skips
	{ font-size:15pt; font-weight:bold; border:1px solid #ccc; background-color:#ddd; padding:12px; margin:5px; text-align:center; cursor:pointer; width:70px; }
  .answer-options div:hover { border:1px solid #666; }
  .face { display:inline-block; width:128px; height:120px; float:left; }
  .face-good { background:url('img/math-good-128.png') no-repeat 0px -10px; }
  .face-bad  { background:url('img/math-bad-128.png') no-repeat 0px -10px; }
  .face-idle { background:url('img/math-idle-128.png') no-repeat 0px -10px; }
  .actionlink   { display:inline-block; padding:2px 5px; cursor:pointer; font-size:16pt; }
  .actionlink-1 { background-color:#009; color:#fff; }
  .sel { background-color:#cfc !important; }
  .bad { background-color:#fbb !important; }
  #timerContainer { background-color:#aaa; width:240px; height:12px; margin:10px auto 3px; }
  #timer { height:12px; background-color:#f00; width:0px; }
  #playing { display:none; }
  #endscreen { display:none; }
  .outcomecell { display:inline-block; font-size:15pt; font-weight:bold; border:1px solid #ccc; background-color:#ddd; padding:6px; margin:5px; text-align:center; cursor:pointer; width:64px; }
  .note { font-size:12pt; }
</style>
<body>
<center>
	<img src="img/logo.png" />
</center>

<div id="menu">
<center>
	<strong style="font-size:16pt;">Solve the most problems in <br/>2 minutes!!</strong><br/>
</center>
	<span class="ui-corner-all actionlink actionlink-1" id="action-supereasy">Super Easy</span>
	<span class="note">add, substract</span>
	<br/>
	<span class="ui-corner-all actionlink actionlink-1" id="action-easy">Easy</span>
	<span class="note">add, substract, multiply</span>
	<br/>
	<span class="ui-corner-all actionlink actionlink-1" id="action-normal">Normal</span>
	<span class="note">add, substract, multiply, divide</span>
	<br/>
	<span class="ui-corner-all actionlink actionlink-1" id="action-hard">Hard</span>
	<span class="note">trig... jk :)</span>
	<br/><br/>
	<span class="ui-corner-all actionlink actionlink-1" id="action-start">Start :)</span>

</div><!-- #menu -->

<div id="playing">
<div id="timerContainer">
	<div id="timer"></div> 
</div>


<div class="operation ui-corner-all">
	<span class="face face-idle" id="mood-face"></span>
	<span class="number" id="number1"> x </span> <span class="operator" id="operator"> ? </span>
	<br/>
	<span class="number number2" id="number2"> y </span>
	<span class="skip actionlink actionlink-1 ui-corner-all" id="action-skip">Skip</span>
</div>
<br/>
<div class="answer-options"></div>
<br/>
	<span class="ui-corner-all sel" id="goodOnes"> :) </span>
	<span class="ui-corner-all bad" id="badOnes"> :( </span>
	<span class="ui-corner-all" id="skips"> :| </span>
	
	<br/><br/>
	<span class="ui-corner-all actionlink actionlink-1" id="action-end">End Session</span>
	
</div><!-- #playing -->

<div id="endscreen">
	<h3>Session Over</h3>
	Your Score:<br/>
	<div class="ui-corner-all outcomecell sel">Good: <br/> <span id="outcome-good"> :) </span> </div>
	<div class="ui-corner-all outcomecell bad">Bad:  <br/> <span id="outcome-bad"> :(</span> </div>
	<div class="ui-corner-all outcomecell">Skips:    <br/> <span id="outcome-skips"> :| </span> </div>
	<br/><br/>
	<span class="ui-corner-all actionlink actionlink-1" id="action-playagain">Play Again</span>
	<br/>
</div>

<script type="text/javascript">
	



	//sp: agregar funcion shuffle a arrays de js para revolver sus elementos
	Array.prototype.shuffle = function () {
		var len = this.length;
		var i = len;
		while (i--) {
			var p = parseInt(Math.random()*i);
			var t = this[i];
			this[i] = this[p];
			this[p] = t;
		}
	};
	
	var _op = turbomath.getRandomOperation();
	/*
	_op.n1 = 9;
	_op.n2 = 7;
	_op.op = turbomath.Constants.Addition;
	_op.answer = 16;
	_op.options = [ 12, 14, 16, 18, 20, 22 ];

	var _gameState = {};
	_gameState.goodOnes = 0;
	_gameState.skips = 0;
	_gameState.badOnes = 0;
	_gameState.seconds = 0;
	
	_gameState.difficulty = {};
	_gameState.difficulty.n1min = 10;
	_gameState.difficulty.n1max = 30;
	_gameState.difficulty.n2min = 0;
	_gameState.difficulty.n2max = 20;
	*/
	
	$(document).ready(function () {
		turbomath.getRandomOperation();
		
		$(".possibleAnswer").live("click", function () {
			var $this = $(this);
			$("#mood-face").removeClass("face-good").removeClass("face-idle").removeClass("face-bad");
			$("#mood-face").addClass($this.data("face"));
			if ($("#mood-face").hasClass("face-good")) {
				$this.addClass("sel");
				if (!$this.hasClass("clicked")) {
					turbomath.session.goodOnes += 1;
					turbomath.session.seconds -= 0.10;
					pulseGood();
				}
				$("#action-skip").text("Next");
				turbomath.getRandomOperation();
			} else {
				$this.addClass("bad");
				if (!$this.hasClass("clicked")) turbomath.session.badOnes += 1;
				pulseBad();
			}
			$this.addClass("clicked");
			showGameState();
		});
		
		$("#action-end").on("click", function () {
			turbomath.session.seconds = -1;
			showMenu();
		});
		
		$("#action-skip").on("click", function () {
			$("#mood-face").removeClass("face-good").removeClass("face-idle").removeClass("face-bad");
			$("#mood-face").addClass("face-idle");
			if ($(this).text()=="Skip") turbomath.session.skips += 1;
			turbomath.getRandomOperation();
		});
		
		$("#action-start").on("click", function () {
			startGame();
			
		});
		
		$("#action-supereasy").on("click", function () {
			turbomath.session.difficulty.setToSuperEasy();
			turbomath.getRandomOperation();
			startGame();
		});
		$("#action-easy").on("click", function () {
			turbomath.session.difficulty.setToEasy();
			turbomath.getRandomOperation();
			startGame();
		});
		$("#action-normal").on("click", function () {
			turbomath.session.difficulty.setToNormal();
			turbomath.getRandomOperation();
			startGame();
		});
		$("#action-hard").on("click", function () {
			turbomath.session.difficulty.setToHard();
			turbomath.getRandomOperation();
			startGame();
		});
		
		$("#action-playagain").on("click", function () {
			turbomath.getRandomOperation();
			startGame();
		});
		
		
	});
	
	function showMenu() {
		$("#menu").show();
		$("#endscreen").hide();
		$("#playing").hide();
	}
	function startGame() {
		$("#menu").hide();
		$("#endscreen").hide();
		$("#playing").show();
		turbomath.session.goodOnes = 0;
		turbomath.session.badOnes = 0;
		turbomath.session.skips = 0;
		turbomath.session.seconds = 0;
		startTimer();
	}
	function endGame() {
		$("#menu").hide();
		$("#endscreen").show();
		$("#playing").hide();
		$("#outcome-good").text(turbomath.session.goodOnes);
		$("#outcome-bad").text(turbomath.session.badOnes);
		$("#outcome-skips").text(turbomath.session.skips);
		
	}
	
	function showOperation(op) {
		$("#number1").text(op.n1);
		$("#number2").text(op.n2);
		$("#operator").text(op.op);
		var htm = "";
		op.options.shuffle();
		for (var i = 0, z = op.options.length; i < z; i++) {
			var dataFace = 'face-bad';
			if (op.options[i] == op.answer) dataFace = 'face-good';
			htm += "<div class='number ui-corner-all possibleAnswer' data-face='" + dataFace + "'>" + op.options[i] + "</div>";
		}	
		htm += "";
		$(".answer-options").html(htm);
		$("#action-skip").text("Skip");
		showGameState();
	}
	function showGameState() {
		$("#goodOnes").text(turbomath.session.goodOnes);
		$("#badOnes").text(turbomath.session.badOnes);
		$("#skips").text(turbomath.session.skips);
	}

	function pulseGood() {
		var startColor = $(".operation").css('background-color');
		$(".operation")
			.css({'background-color':'#77cc77'})
			.animate({'background-color':startColor}, 600, function () {
			
			});
	}
	function pulseBad() {
		var startColor = $(".operation").css('background-color');
		$(".operation")
			.css({'background-color':'#dd9944'})
			.animate({'background-color':startColor}, 600, function () {
			
			});
	}
	
</script>
</body>
</html>